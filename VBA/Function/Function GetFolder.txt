Function GetFolder() As String
Dim fldr As FileDialog
Dim sItem As String
Set fldr = Application.FileDialog(msoFileDialogFolderPicker)
With fldr
        .Title = "Select a folder"
        .AllowMultiSelect = False
        .InitialFileName = Application.DefaultFilePath
        
        If .Show <> -1 Then GoTo Nextcode
        sItem = .SelectedItems(1)
End With
Nextcode:
GetFolder = sItem
Set fldr = Nothing
End Function