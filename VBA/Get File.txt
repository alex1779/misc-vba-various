Function GetFile() As String
Dim fldr As FileDialog
Dim sItem As String
Set fldr = Application.FileDialog(msoFileDialogFilePicker)
With fldr
        .Title = "Select the file"
        .AllowMultiSelect = False
        .InitialFileName = Application.DefaultFilePath
        If .Show <> -1 Then GoTo Nextcode
        sItem = .SelectedItems(1)
End With
Nextcode:
GetFile = sItem
Set fldr = Nothing
End Function

Dim FSO As New FileSystemObject
nombre = GetFile
UserForm1.TextBox2.Value = FSO.GetFileName(nombre)